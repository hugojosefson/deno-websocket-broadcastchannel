@startuml
hide empty description
skinparam shadowing true
skinparam ArrowFontColor #bbb
skinparam ArrowFontStyle italic
skinparam ArrowColor blue
skinparam ArrowThickness 0.2
skinparam StateFontColor blue
skinparam StateBackgroundColor lightblue
skinparam StateBorderColor blue
skinparam StateBorderThickness 2
title "WebSocketClientServer\nState Machine"
state "server wannabe" as server_wannabe
state "start listening" as start_listening
state "accept next connection" as accept_next_connection
state "address in use" as address_in_use
state "server failed" as server_failed
state "client wannabe" as client_wannabe
state "connect client" as connect_client
state "client" as client
state "client failed" as client_failed
[*] --> server_wannabe
server_wannabe -[thickness=2]-> start_listening
start_listening -[thickness=2]-> address_in_use
start_listening -[thickness=2]-> accept_next_connection
start_listening -[thickness=2]-> server_failed: other error
accept_next_connection -[thickness=2]-> accept_next_connection
accept_next_connection -[thickness=2]-> server_failed: fatal error
address_in_use -[thickness=2]-> client_wannabe
server_failed -[thickness=2]-> client_wannabe
client_wannabe --> connect_client: start connecting
connect_client --> client: connected
connect_client --> client_failed: could not
client --> client_failed: fatal error
client_failed --> server_wannabe
@enduml