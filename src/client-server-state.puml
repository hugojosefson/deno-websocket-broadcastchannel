@startuml
hide empty description
skinparam ArrowFontColor #bbb
skinparam ArrowFontStyle italic
skinparam ArrowColor lightblue
skinparam StateFontColor blue
skinparam StateBackgroundColor lightblue
skinparam StateBorderColor none
title "WebSocketClientServer\nState Machine"
state "server wannabe" as server_wannabe
state "server listen" as server_listen
state "server listener accept" as server_listener_accept
state "server collision" as server_collision
state "server failed" as server_failed
state "client wannabe" as client_wannabe
state "client starting" as client_starting
state "client failed" as client_failed
[*] --> server_wannabe
server_wannabe --> server_listen: start listening
server_listen --> server_collision: address in use
server_listen --> server_listener_accept: accept next connection
server_listen --> server_failed: other error
server_listener_accept --> server_listener_accept: next connection
server_listener_accept --> server_failed: fatal error
server_collision --> client_wannabe: !closed
server_failed --> client_wannabe: !closed
client_wannabe --> client_starting: start connecting
client_starting --> client: connected
client_starting --> client_failed: could not
client --> client_failed: fatal error
client_failed --> server_wannabe: !closed
@enduml